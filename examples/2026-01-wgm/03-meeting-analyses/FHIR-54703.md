# FHIR-54703: Harmonize Procedure.bodyStructure and Observation.bodyStructure

## Issue Overview

This ballot comment identifies an inconsistency between how Procedure and Observation handle body site/structure information in R6:

- **Observation**: `bodySite` deprecated → `bodyStructure` as CodeableReference(BodyStructure)
- **Procedure**: `bodySite` NOT deprecated, `bodyStructure` as Reference(BodyStructure) (not CodeableReference)

The commenter requests harmonization: same datatype, same deprecation approach, same boundaries documentation.

## Current State

### Observation (R6)
- `bodySite` - deprecated (CodeableConcept)
- `bodyStructure` - CodeableReference(BodyStructure) with binding to body site codes
- Clear migration path from bodySite to bodyStructure

### Procedure (R6)  
- `bodySite` - 0..* CodeableConcept - NOT deprecated
- `bodyStructure` - 0..1 Reference(BodyStructure) - NOT CodeableReference
- Cardinality differs: bodySite is 0..*, bodyStructure is 0..1

### Related Issues Identified
- FHIR-54621: Requests changing ServiceRequest.bodyStructure to 0..* (cardinality issue)
- FHIR-51792: Deliberately reverted Procedure.bodyStructure to 0..1 (was briefly 0..*)
- FHIR-41690: Long discussion about multiple bodyStructure needs (radiotherapy use case) - ultimately rejected for 0..*

## Stakeholder Perspectives

**Anja Schwab (Reporter)**: Identified the inconsistency and requests harmonization considering deprecation, boundaries documentation, cardinality, and datatype alignment.

### Zulip Discussion (#Orders and Observation WG > R6 BodyStructure Review)

**Brian Postlethwaite**: Noticed Procedure still has both bodySite and bodyStructure, unlike Observation. Asked if this was oversight.

**Marti Velezis (OO WG)**: "We did not make changes to other WGs Resources. I know we discussed with PC and II that we were moving away from bodySite (even deprecating it in Observation) to move to bodyStructure as a codeableReference."

**Michelle (Moseman) Miller (Patient Care)**: Clarified the difference is intentional due to cardinality:
- bodySite is 0..* (multiple body sites allowed)
- bodyStructure is 0..1 (intentionally - discussed at length with OO/PC)
- References FHIR-51792 which "intentionally reverted" the cardinality change

### FHIR-41690 Discussion (Detailed)
Martin von Siebenthal (CodeX Radiotherapy) argued extensively for 0..* bodyStructure:
- Radiotherapy treats multiple distinct body structures (tumors, organs at risk) in single procedure
- Creating artificial combined BodyStructures "has clinically no meaning"
- Patient Care ultimately voted against 0..* because BodyStructure.includedStructure already allows 1..*

## Related Issues & Discussions

### Jira Issues
- **FHIR-54621**: ServiceRequest bodyStructure 0..1 → 0..* (same concern, different resource)
- **FHIR-51792** (Applied): Reverted Procedure.bodyStructure to 0..1 (deliberate decision)
- **FHIR-41690** (Not Persuasive): Multiple bodyStructure request rejected after extensive discussion
- **FHIR-48110**: Related discussion about morphology in BodyStructure

### Key Design Decision
The current approach relies on BodyStructure.includedStructure (1..*) to represent multiple sites within a single BodyStructure reference, rather than allowing multiple BodyStructure references.

## Technical Considerations

1. **Datatype Difference**:
   - CodeableReference allows either code or reference or both
   - Plain Reference requires actual BodyStructure resource
   - CodeableReference is more flexible for simple cases

2. **Cardinality Philosophy**:
   - Observation: single body site typically relevant
   - Procedure: multiple sites may be relevant, but can be combined in BodyStructure.includedStructure

3. **Migration Impact**:
   - Deprecating Procedure.bodySite would require migration path
   - Changing Reference to CodeableReference is non-breaking (additive)

4. **Consistency vs Use Case**:
   - Different resources may have legitimately different needs
   - But inconsistency creates learning curve and mapping challenges

5. **BodyStructure as Aggregator**:
   - Current design expects BodyStructure to aggregate multiple sites internally
   - This was deliberate decision per FHIR-41690 resolution

## Potential Courses of Action

### Option A: Full Harmonization with Observation Pattern
- **Description**: 
  - Change Procedure.bodyStructure to CodeableReference(BodyStructure)
  - Deprecate Procedure.bodySite
  - Add same value set binding as Observation
- **Pros**: Consistency; easier mapping; follows newer pattern
- **Cons**: Breaking change; cardinality still differs; may not fit all Procedure use cases
- **Impact**: High - breaking for Procedure implementations

### Option B: Partial Harmonization (Datatype Only)
- **Description**: Change Procedure.bodyStructure to CodeableReference but keep bodySite and current cardinality
- **Pros**: Improves flexibility; non-breaking; preserves design decisions
- **Cons**: Still inconsistent deprecation approach; two parallel elements remain
- **Impact**: Medium - additive datatype change

### Option C: Document Intentional Difference
- **Description**: Add documentation explaining why Procedure differs from Observation; no structural changes
- **Pros**: Acknowledges use case differences; no change risk; respects prior decisions
- **Cons**: Doesn't address datatype inconsistency; leaves learning curve
- **Impact**: Low - documentation only

### Option D: Revisit Cardinality Decision
- **Description**: Re-open FHIR-41690/FHIR-51792 decisions about 0..* cardinality, then harmonize
- **Pros**: Addresses root cause if radiotherapy use case is compelling
- **Cons**: Contradicts recent deliberate decisions; requires consensus change
- **Impact**: High - requires policy reversal and structural change

## Questions for the Workgroup

1. Should Procedure follow Observation's pattern, or are the differences intentional and justified?

2. Is CodeableReference preferred over plain Reference for all bodyStructure elements going forward?

3. Should bodySite be deprecated in Procedure, or is there value in keeping both patterns?

4. How does the radiotherapy use case (FHIR-41690) factor into this decision?

5. Is this a FHIR-I question, Patient Care question, or joint question?

6. What's the precedent for cross-resource consistency vs use-case-driven variation?

## References

- Jira Issue: https://jira.hl7.org/browse/FHIR-54703
- Cardinality: https://jira.hl7.org/browse/FHIR-54621
- Procedure revert: https://jira.hl7.org/browse/FHIR-51792
- Multiple bodyStructure discussion: https://jira.hl7.org/browse/FHIR-41690
- Procedure: https://build.fhir.org/procedure.html
- Observation: https://build.fhir.org/observation.html
- Zulip: https://chat.fhir.org/#narrow/stream/Orders%20and%20Observation%20WG/topic/R6%20BodyStructure%20Review
