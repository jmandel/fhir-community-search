# FHIR-54779: StructureMap and Mapping Language

## Issue Overview

This ballot comment recommends moving StructureMap resource and the FHIR Mapping Language (FML) out of the core specification into an "Additional Resource IG" due to limited adoption and incomplete support in major FHIR libraries.

This is a significant proposal that would affect the status and location of a core transformation capability in FHIR.

## Current State

StructureMap and the FHIR Mapping Language:
- Have been part of FHIR since early versions
- Provide a declarative way to transform between FHIR resources and other data formats
- Are used in some IGs (e.g., CDA-to-FHIR transforms, cross-version mapping)
- Have partial implementation support:
  - HAPI FHIR: Has StructureMap support
  - Matchbox: Active FML support (ahdis)
  - FHIRPath Lab: Provides FML playground (Brian Postlethwaite)
  - Others: Varying levels of support

The commenter states: "the mapping language has seen very little adoption and is not or only partly supported by the main FHIR libraries."

## Stakeholder Perspectives

**Bas van den Heuvel (Reporter)**: Believes the low adoption and incomplete library support justify moving to Additional Resource IG status.

### Zulip Evidence of Active Use
Recent Zulip activity shows active FML community:
- **#FHIR Mapping Language** stream has ongoing discussions
- Brian Postlethwaite maintains FHIRPath Lab with FML support
- Oliver Egger maintains Matchbox with FML execution
- Users actively asking questions about StructureMap transformations
- Recent IG builds show StructureMap usage (Tanzania, Denmark, etc.)

**Vadim Peretokin** (Zulip): "the FML community is small but we are dedicated"

## Related Issues & Discussions

### Zulip Activity (Recent)
- **#fhir/infrastructure-wg > StructureMap playground**: Active discussion about tooling (Jan 2026)
- **#FHIR Mapping Language > A simple transformation**: User questions about FML usage
- Multiple IG builds using StructureMap visible in build notifications

### Additional Resources Context
The R6 ballot already moved several resources to "Additional Resource IGs":
- TestScript, TestPlan, TestReport → Testing IG
- GraphDefinition → API Incubator IG
- Various others

The "Additional Resources" pattern (see Josh Mandel's summary) is designed for content that:
- Is official HL7 FHIR
- Keeps same canonicals under "http://hl7.org/fhir"
- Can iterate between releases
- May graduate back to core or retire

## Technical Considerations

1. **FML Complexity**: The mapping language is complex and requires significant implementation effort - may explain partial library support

2. **Use Cases**:
   - Cross-version transformations (R4 → R5 → R6)
   - CDA-to-FHIR conversion
   - Logical model transformations
   - IG-specific data mapping

3. **Alternative Approaches**: Some implementers use other transformation technologies (XSLT, custom code, etc.) instead of FML

4. **Tooling State**:
   - Validator supports FML syntax
   - IG Publisher can process StructureMaps
   - Execution engines exist but aren't universal

5. **Normative Implications**: If StructureMap stays in core and becomes normative, future evolution is constrained

6. **Dependency Analysis**: What IGs depend on StructureMap being in core?

## Potential Courses of Action

### Option A: Move to Additional Resource IG
- **Description**: Move StructureMap and FML documentation to dedicated Additional Resource IG (e.g., "Mapping IG" or "Transformation IG")
- **Pros**: Allows faster iteration; acknowledges limited adoption; reduces core complexity; follows pattern for immature content
- **Cons**: May signal abandonment; complicates dependency management; affects IGs using it; community pushback
- **Impact**: High - significant reorganization

### Option B: Keep in Core, Mark as Trial-Use Area
- **Description**: Keep in core but explicitly mark as trial-use area that may move to Additional Resource later
- **Pros**: Preserves current location; signals evolution may come; doesn't disrupt current users
- **Cons**: Inconsistent with "fully normative R6" goal; doesn't address adoption concerns
- **Impact**: Low - status annotation only

### Option C: Keep in Core as Informative
- **Description**: Keep StructureMap in core but mark as Informative rather than Normative
- **Pros**: Stays in core; flexibility for changes; acknowledges maturity state
- **Cons**: Resources can't easily be "informative"; doesn't follow R6 pattern
- **Impact**: Medium - maturity classification

### Option D: Not Persuasive - Keep as Normative
- **Description**: Reject proposal; proceed with StructureMap as normative core content
- **Pros**: Stability; signals commitment; existing users not disrupted
- **Cons**: May lock in under-adopted feature; contradicts "low adoption" assessment
- **Impact**: None - status quo

### Option E: Gather Implementation Data First
- **Description**: Defer decision pending actual implementation survey to validate adoption claims
- **Pros**: Evidence-based decision; respects active community; avoids premature action
- **Cons**: Delays decision; may not change conclusion
- **Impact**: Deferred - research action

## Questions for the Workgroup

1. What is the actual adoption level of StructureMap/FML? Is there data beyond anecdotal?

2. Which FHIR libraries support FML execution, and to what degree?

3. What IGs depend on StructureMap being in core vs available as Additional Resource?

4. Is "not fully implemented in libraries" a valid criterion for Additional Resource status?

5. Would moving to Additional Resource IG actually help or hurt FML adoption?

6. What does the active FML community (Matchbox, FHIRPath Lab developers) think?

7. Are the cross-version transformation use cases important enough to justify core status?

## References

- Jira Issue: https://jira.hl7.org/browse/FHIR-54779
- StructureMap: https://build.fhir.org/structuremap.html
- Mapping Language: https://build.fhir.org/mapping-language.html
- Additional Resources Pattern: https://chat.fhir.org/#narrow/stream/fhir%2Finfrastructure-wg/topic/Additional%20Resources
- FHIRPath Lab FML: https://dev.fhirpath-lab.com/fml
- Matchbox: https://test.ahdis.ch/matchbox/mappinglanguage
